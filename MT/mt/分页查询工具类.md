```java


package com.sankuai.mall.mds.dao.util;  
  
import com.google.common.collect.Lists;  
import com.google.common.collect.Maps;  
import org.apache.commons.collections4.CollectionUtils;  
import org.apache.commons.collections4.ListUtils;  
  
import java.util.Collections;  
import java.util.List;  
import java.util.Map;  
import java.util.concurrent.CompletableFuture;  
import java.util.concurrent.ExecutorService;  
import java.util.function.Consumer;  
import java.util.function.Function;  
  
/**  
 * @description: * @author: liya11 * @create: 2023/4/26 17:28 
 * 
 **/
 public class PageUtil {  
  
    /**  
     * 分页执行consumer  
     *     * @param consumer  
     * @param paramList  
     * @param pageSize  
     * @param <T>  
     */  
    public static <T> void doConsumerByPage(Consumer<List<T>> consumer, List<T> paramList, int pageSize) {  
        if (CollectionUtils.isEmpty(paramList)) {  
            return;  
        }  
        List<List<T>> partition = ListUtils.partition(ListUtils.emptyIfNull(paramList), pageSize);  
        for (List<T> each : partition) {  
            consumer.accept(each);  
        }  
    }  
  
    /**  
     * 分页执行consumer 并发执行  
     *  
     * @param consumer  
     * @param paramList  
     * @param pageSize  
     * @param executorService  
     * @param <T>  
     */  
    public static <T> void doConsumerByPage(Consumer<List<T>> consumer, List<T> paramList, int pageSize, ExecutorService executorService) {  
        if (CollectionUtils.isEmpty(paramList)) {  
            return;  
        }  
        List<List<T>> partition = ListUtils.partition(ListUtils.emptyIfNull(paramList), pageSize);  
        List<CompletableFuture<Void>> futures = Lists.newArrayList();  
        for (List<T> each : partition) {  
            futures.add(CompletableFuture.runAsync(() -> consumer.accept(each), executorService));  
        }  
        futures.forEach(CompletableFuture::join);  
    }  
  
  
    /**  
     * 分页执行function  
     *     * @param function  
     * @param paramList 参数列表  
     * @param pageSize  分页大小  
     * @param <T>  
     * @param <R>  
     * @return  
     */    public static <T, R> List<R> doFunctionByPage(Function<List<T>, List<R>> function, List<T> paramList,  
                                                  int pageSize) {  
        if (CollectionUtils.isEmpty(paramList)) {  
            return Collections.emptyList();  
        }  
        List<R> result = Lists.newArrayList();  
        List<List<T>> partition = ListUtils.partition(ListUtils.emptyIfNull(paramList), pageSize);  
        for (List<T> each : partition) {  
            result.addAll(function.apply(each));  
        }  
        return result;  
    }  
  
    /**  
     * 分页执行function 多线程执行  
     *  
     * @param function  
     * @param paramList  
     * @param pageSize  
     * @param executorService  
     * @param <T>  
     * @param <R>  
     * @return  
     */    public static <T, R> List<R> doFunctionByPage(Function<List<T>, List<R>> function, List<T> paramList,  
                                                  int pageSize, ExecutorService executorService) {  
        if (CollectionUtils.isEmpty(paramList)) {  
            return Collections.emptyList();  
        }  
        List<R> result = Lists.newArrayList();  
        List<List<T>> partition = ListUtils.partition(ListUtils.emptyIfNull(paramList), pageSize);  
        List<CompletableFuture<List<R>>> futures = Lists.newArrayList();  
        for (List<T> each : partition) {  
            futures.add(CompletableFuture.supplyAsync(() -> function.apply(each), executorService));  
        }  
        futures.forEach(x -> result.addAll(x.join()));  
        return result;  
    }  
  
    /**  
     * 执行分页函数并返回结果的映射  
     *  
     * @param function  
     * @param paramList  
     * @param pageSize  
     * @param executorService  
     * @return  
     * @param <T>  
     * @param <K>  
     * @param <V>  
     */  
    public static  <T, K, V> Map<K, V> doFunctionMapByPage(Function<List<T>, Map<K, V>> function, List<T> paramList,  
                                                   int pageSize, ExecutorService executorService) {  
        if (CollectionUtils.isEmpty(paramList)) {  
            return Collections.emptyMap();  
        }  
        Map<K, V> result = Maps.newHashMap();  
        List<List<T>> partition = ListUtils.partition(ListUtils.emptyIfNull(paramList), pageSize);  
        List<CompletableFuture<Map<K, V>>> futures = Lists.newArrayList();  
        for (List<T> each : partition) {  
            futures.add(CompletableFuture.supplyAsync(() -> function.apply(each), executorService));  
        }  
        futures.forEach(x -> result.putAll(x.join()));  
        return result;  
    }  
  
    /**  
     * 执行分页函数并返回结果的映射  
     *  
     * @param function  
     * @param paramList  
     * @param pageSize  
     * @param executorService  
     * @return  
     * @param <T>  
     * @param <K>  
     * @param <V>  
     */  
    public static  <T, K, V> Map<K, V> doFunctionMapByPage(Function<List<T>, Map<K, V>> function, List<T> paramList,  
                                                           int pageSize) {  
        if (CollectionUtils.isEmpty(paramList)) {  
            return Collections.emptyMap();  
        }  
        Map<K, V> result = Maps.newHashMap();  
        List<List<T>> partition = ListUtils.partition(ListUtils.emptyIfNull(paramList), pageSize);  
        for (List<T> each : partition) {  
            result.putAll(function.apply(each));  
        }  
        return result;  
    }  
}


```