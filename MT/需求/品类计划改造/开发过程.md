1. 调整方式封装为接口，默认返回数量
2. 与产品沟通计划调整方式改为54条数据 有可能存在54周
3. 三级品类查询时，不过滤操作人，二级品类查询时过滤操作人






**已办**


给算法接口
问算法要接口
催思阳要数仓对数据


## 撤销
迁移新代码到进销存服务：由于数据库，机器配置暂未迁移，目前品类计划一期暂时在mds开发


## 2024/10/9

1. 算法引包优化，由进销存服务提供
```xml
<dependency>
  <groupId>com.sankuai.mall.scm.sentinel</groupId>
  <artifactId>mall-scm-sentinel-client</artifactId>
  <version>2.0.3-category-plan-SNAPSHOT</version>
</dependency>
```

2. 配置lion
	- exception_notice_person
	- sales_forecast_exception_notify_mis_list
	- category_plan_config_export_limit

3. mafka导入excel审批
4. 引入算法包更新
5. 接口文档记得更新访问路径名
6. 删除快照表的createDate




问题：

日期列只有月份
key:2024/08/30

titile:08/30

周是两行

key: W28

title: 09/30 - 10/09






## 配置

导出线程池 commonExportExcelPool 2 10 linked 500

配置查询列表线程池 categoryPlanQueryListPool 5:10 同步队列

查询算法线程池 queryCategoryPlanForecastPool    15：20  Linked队列 50


**lion**

category_plan_config_export_limit:1000


【使用场景】品类计划配置导出限制条数
【值描述】导出条数限制
【关联需求】
 注：关联需求内容可以选填


Crane

mds_sync_category_plan_offline_sales_by_day

同步品类计划离线销量byDay


XT: 任务


**10.21**

1. 算法接口支持单日多品类，需要根据线程池查询，查询35天的数据
2. 查询列表数据格式

**10.22**

1. 算法接口支持单日多品类，需要根据线程池查询，查询35天的数据
2. 查询列表排序
3. cap校验促销协同修改
4. 离线数据

**10.23**

1. 代码CR问题修改
2. 算法接口暂时取消调用 等算法部署
3. 离线数据同步
4. 历史转换系数mock逻辑

**10.24**

1. 查询列表周维度计算逻辑改造
2. 离线数据处理
3. 泳道自测

**10.25**

1. 联调问题修改
2. 离线数据
3. 周会



**离线数据获取**

理论销量：从Hive通过XT同步到Cellar 在通过定时任务同步到离线表（城市+业务分组+品类+dt维度）

历史预测：从Hive通过XT同步到 Cellar 在通过定时任务同步到离线表（城市+业务分组+品类+dt维度） 定时任务计算比例

T0-T35预测：查询算法接口（城市+业务分组+品类+dt维度）



历史4周销售转换系数：从Hive通过XT同步的Cellar，查询Cellar获取（城市+业务分组+品类+周维度）以星期一表示本周

共需要两张Hive表

```sql

-- 历史销售订货转换系数表
select * from app_mall_data.app_scp_plan_ordering_mcity_flag_cate3_dt;

-- 历史销量表
select * from mart_mallpa.topic_sc_ars_sale_forecast_category_plan_prediction_info_output;

```

